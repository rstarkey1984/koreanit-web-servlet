<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ë¡œê·¸ì¸ + ê²Œì‹œíŒ + í˜ì´ì§•</title>

    <!-- ê²Œì‹œíŒ ì „ìš© CSS -->
    <link rel="stylesheet" href="style.css" />

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- API í˜¸ì¶œ í•¨ìˆ˜ë“¤ (ì„œë²„ í†µì‹ ) -->
    <script src="api.js"></script>
  </head>

  <body>
    <div id="app">
      <div class="container">
        <!-- ë¡œê·¸ì¸ / íšŒì›ê°€ì… -->
        <section>
          <div class="flex-between">
            <h1>ë¡œê·¸ì¸</h1>
            <span v-if="isLogin">ğŸ˜Š {{ login_user_id }} ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.</span>
          </div>

          <p v-if="login_error_msg" class="alert-error">
            {{ login_error_msg }}
          </p>

          <!-- ë¡œê·¸ì¸ O -->
          <form v-if="isLogin" @submit.prevent="logout" class="card">
            <div class="flex-between">
              <span>í˜„ì¬ ë¡œê·¸ì¸: <strong>{{ login_user_id }}</strong></span>
              <button type="submit" class="secondary">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
          </form>

          <!-- ë¡œê·¸ì¸ X -->
          <div v-else>
            <!-- ë¡œê·¸ì¸ í¼ -->
            <form @submit.prevent="login" class="card">
              <h2 style="margin-top: 0; margin-bottom: 12px">ë¡œê·¸ì¸</h2>

              <label>ì•„ì´ë””</label>
              <input type="text" v-model="input_user_id" />

              <label class="mt-8">ë¹„ë°€ë²ˆí˜¸</label>
              <input type="password" v-model="input_user_password" />

              <div class="text-right mt-8">
                <button class="primary">ë¡œê·¸ì¸</button>
              </div>
            </form>

            <!-- íšŒì›ê°€ì… ê²°ê³¼/ì—ëŸ¬ -->
            <p v-if="register_error_msg" class="alert-error">
              {{ register_error_msg }}
            </p>
            <p v-if="register_success_msg" class="alert-success">
              {{ register_success_msg }}
            </p>

            <!-- íšŒì›ê°€ì… í¼ -->
            <form @submit.prevent="register" class="card">
              <h2 style="margin-top: 0; margin-bottom: 12px">íšŒì›ê°€ì…</h2>

              <label>ì•„ì´ë””</label>
              <input
                type="text"
                v-model="reg_user_id"
                placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
              />

              <label class="mt-8">ë¹„ë°€ë²ˆí˜¸</label>
              <input
                type="password"
                v-model="reg_user_password"
                placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
              />

              <label class="mt-8">ì´ë©”ì¼</label>
              <input
                type="text"
                v-model="reg_user_email"
                placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
              />

              <div class="text-right mt-8">
                <button class="secondary">íšŒì›ê°€ì…</button>
              </div>
            </form>
          </div>
        </section>

        <hr />

        <!-- ê¸€ì“°ê¸° -->
        <section id="writeSection">
          <div class="flex-between">
            <h2>{{ write_edit_str }}</h2>
            <button
              v-show="btn_edit_cancel_show"
              @click="btn_edit_cancel"
              type="button"
              class="secondary"
            >
              ì·¨ì†Œ
            </button>
          </div>

          <p v-if="board_error_msg" class="alert-error">
            {{ board_error_msg }}
          </p>

          <form @submit.prevent="write" class="card">
            <p v-if="!isLogin" class="alert-error">
              ê¸€ì“°ê¸°ëŠ” ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </p>

            <label>ì œëª©</label>
            <input
              id="titleInput"
              type="text"
              v-model="input_title"
              :disabled="!isLogin"
              maxlength="45"
            />

            <label class="mt-8">ë‚´ìš©</label>
            <textarea
              v-model="textarea_content"
              rows="6"
              :disabled="!isLogin"
            ></textarea>

            <div class="text-right mt-8">
              <button class="primary" :disabled="!isLogin">
                {{ btn_write_show ? "ë“±ë¡" : "ìˆ˜ì •í•˜ê¸°" }}
              </button>
            </div>
          </form>
        </section>

        <hr />

        <!-- ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸° -->
        <section id="detailSection" v-if="selectedBoard">
          <div class="card">
            <div class="flex-between">
              <h2>ê²Œì‹œê¸€ ìƒì„¸</h2>
              <button type="button" class="secondary" @click="closeDetail">
                ë‹«ê¸°
              </button>
            </div>

            <p class="detail-title">{{ selectedBoard.title }}</p>

            <p class="detail-meta">
              ë²ˆí˜¸: {{ selectedBoard.idx }} Â· ì‘ì„±ì: {{
              selectedBoard.fk_user_id }} Â· ì‘ì„±ì¼: {{ selectedBoard.regDate }}
            </p>

            <div class="detail-content">{{ selectedBoard.content }}</div>
          </div>
        </section>

        <hr />

        <!-- ê²Œì‹œíŒ -->
        <section>
          <div class="flex-between">
            <h2>ê²Œì‹œê¸€ ëª©ë¡</h2>
            <span class="board-summary">
              ì´ {{ totalCount }} ê±´ ({{ currentPage }} / {{ totalPages }}
              í˜ì´ì§€)
            </span>
          </div>

          <!-- ëª©ë¡ -->
          <table>
            <thead>
              <tr>
                <th>ë²ˆí˜¸</th>
                <th>ì œëª©</th>
                <th>ë‚´ìš©</th>
                <th>ì‘ì„±ì</th>
                <th>ì‘ì„±ì¼</th>
                <th>ì•¡ì…˜</th>
              </tr>
            </thead>

            <tbody>
              <tr v-if="board_list.length === 0">
                <td colspan="6">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
              </tr>

              <tr v-for="b in board_list" :key="b.idx">
                <td>{{ b.idx }}</td>

                <!-- ì œëª©: í•œ ì¤„ ë§ì¤„ì„ + í´ë¦­ ì‹œ ìƒì„¸ë³´ê¸° -->
                <td
                  class="col-title clickable-cell"
                  :title="b.title"
                  @click="showDetail(b)"
                >
                  {{ b.title }}
                </td>

                <!-- ë‚´ìš©: ì—¬ëŸ¬ ì¤„ ì¤‘ ì¼ë¶€ë§Œ + í´ë¦­ ì‹œ ìƒì„¸ë³´ê¸° -->
                <td
                  class="col-content clickable-cell"
                  :title="b.content"
                  @click="showDetail(b)"
                >
                  <div class="col-content-text">{{ b.content }}</div>
                </td>

                <td>{{ b.fk_user_id }}</td>
                <td>{{ b.regDate }}</td>
                <td>
                  <button
                    v-if="b.fk_user_id === login_user_id"
                    class="secondary"
                    @click="btn_edit_board(b)"
                  >
                    ìˆ˜ì •
                  </button>
                  <button
                    v-if="b.fk_user_id === login_user_id"
                    class="danger ml-4"
                    @click="btn_delete_board(b.idx)"
                  >
                    ì‚­ì œ
                  </button>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- í˜ì´ì§• -->
          <div class="mt-16 pagination text-center">
            <button
              class="secondary"
              @click="goPage(currentPage - 1)"
              :disabled="currentPage <= 1"
            >
              ì´ì „
            </button>

            <button
              v-for="p in pageNumbers"
              :key="p"
              class="secondary"
              @click="goPage(p)"
              :disabled="p === currentPage"
              :style="p === currentPage ? 'font-weight:bold;text-decoration:underline' : ''"
            >
              {{ p }}
            </button>

            <button
              class="secondary"
              @click="goPage(currentPage + 1)"
              :disabled="currentPage >= totalPages"
            >
              ë‹¤ìŒ
            </button>
          </div>
        </section>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
