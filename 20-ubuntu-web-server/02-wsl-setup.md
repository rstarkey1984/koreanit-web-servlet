# WSL Ubuntu ë¥¼ ì‹¤ì œ ê°œë°œì„œë²„ ì ‘ì†ê³¼ ë™ì¼í•˜ê²Œ êµ¬ì„±í•˜ê¸°

## ğŸ“˜ í•™ìŠµ ê°œìš”
WSL Ubuntu ë¥¼ ì‹¤ì œ ê°œë°œì„œë²„ì™€ ë™ì¼í•˜ê²Œ ì„¤ì •í•˜ê¸° ìœ„í•´ ìœˆë„ìš° ë””ë ‰í„°ë¦¬ë¥¼ ì–¸ë§ˆìš´íŠ¸ í•˜ê³  SSH ì ‘ì†ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•œë‹¤.

- ì•„ë˜ ë‹¨ê³„ë¥¼ ì§„í–‰í•˜ê¸° ì „,
   - VSCode [Remote - SSH ( Extension )](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh) ì„¤ì¹˜
   - Ubuntu ì„œë²„ hosts, hostname ì²´í¬

## ğŸ’¡ ì£¼ìš” ë‚´ìš©
- WSL Ubuntu ì¸ìŠ¤í„´ìŠ¤ì˜ ì˜ë¯¸
- WSL Ubuntu ì—ì„œ ìœˆë„ìš° ë””ë ‰í† ë¦¬ ì–¸ë§ˆìš´íŠ¸(= DrvFS ë„ê¸°)
- Ubuntu ì—ì„œ OpenSSH SSH Server ì„¤ì •
- VSCode ë¡œ Ubuntu ì„œë²„ë¡œ SSH ì ‘ì†

---

### 1. WSL Ubuntu ì¸ìŠ¤í„´ìŠ¤ì˜ ì˜ë¯¸
> Ubuntu ë°°í¬íŒì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“  WSL ì¸ìŠ¤í„´ìŠ¤ 
    
- ì¸ìŠ¤í„´ìŠ¤ë€? ê°€ìƒí™” ê¸°ìˆ ë¡œ ì‹¤í–‰ë˜ëŠ” í•˜ë‚˜ì˜ ë…ë¦½ëœ ìš´ì˜ì²´ì œ í™˜ê²½. ëŒ€í‘œì ìœ¼ë¡œ AWS(ì•„ë§ˆì¡´ ì›¹ ì„œë¹„ìŠ¤) ë‘ GCP(êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼) ì—ì„œ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¡œ ì œê³µí•´ì¤€ë‹¤.

    - AWS ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í™”ë©´ 
        ![AWS ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í™”ë©´ ](https://lh3.googleusercontent.com/d/1sUYUMs8RqBiftkaKWfCYxGjERLd_JSAM)


### 2. WSL Ubuntu ì—ì„œ ìœˆë„ìš° ë””ë ‰í† ë¦¬ ì–¸ë§ˆìš´íŠ¸(= DrvFS ë„ê¸°)
> DrvFS ë„ê¸° : Windows íŒŒì¼ ì‹œìŠ¤í…œ(C:, D: ê°™ì€ ë“œë¼ì´ë¸Œ)ì„ WSL(Ubuntu ë“±)ì— ìë™ìœ¼ë¡œ ë§ˆìš´íŠ¸í•˜ì§€ ì•Šë„ë¡ ì„¤ì •í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

1.  `/etc/wsl.conf` íŒŒì¼ ë‚´ìš© ìˆ˜ì • ( `<hostname>`ì€ ë³¸ì¸ì˜ hostname ìœ¼ë¡œ ìˆ˜ì • )

    ```bash
    sudo sh -c 'cat > /etc/wsl.conf << "EOF"
    [boot]
    systemd = true           # ssh ë“± systemd ì„œë¹„ìŠ¤ ì‚¬ìš©í•˜ë ¤ë©´ ê¶Œì¥

    [user]
    default=<user>

    [automount]
    enabled = false          # /mnt/c ê°™ì€ ìë™ ë§ˆìš´íŠ¸ ì¤‘ì§€
    mountFsTab = true        # /etc/fstab ì‚¬ìš© ì‹œì—ë§Œ ë§ˆìš´íŠ¸

    [interop]
    enabled = false          # ìœˆë„ìš° exe ì‹¤í–‰ ê¸ˆì§€
    appendWindowsPath = false # ìœˆë„ìš° PATH ì„ê¸° ë„ê¸°

    [network]
    generateHosts=false # WSL Ubuntuë¥¼ ì‹¤í–‰í•  ë•Œ, `/etc/hosts` íŒŒì¼ì„ ìë™ìœ¼ë¡œ ë®ì–´ì“°ì§€ ì•Šê¸° ìœ„í•´ ì„¤ì •í•©ë‹ˆë‹¤.
    hostname=<hostname> # WSL Ubuntu ì—ì„œ ì‚¬ìš©í•  hostname  
    EOF'
    ```
    - `sudo sh -c ''` : â€œë£¨íŠ¸ ê¶Œí•œìœ¼ë¡œ ì…¸ì„ ì‹¤í–‰í•˜ë©´ì„œ, ë’¤ì— ì˜¤ëŠ” ëª…ë ¹ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ ì‹¤í–‰â€ í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
    - `cat > /etc/wsl.conf << "EOF"` ëŠ” ë¦¬ëˆ…ìŠ¤ì—ì„œ íŠ¹ì • íŒŒì¼ì„ ì—¬ëŸ¬ ì¤„ ì…ë ¥ìœ¼ë¡œ í•œ ë²ˆì— ìƒì„±/ë®ì–´ì“¸ ë•Œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
        ```
        cat > /etc/wsl.conf << "EOF"
        (ì—¬ê¸°ì— ì…ë ¥í•  ë‚´ìš©ë“¤...)
        EOF
        ```

2. /etc/wsl.conf ìˆ˜ì •ë‚´ìš© í™•ì¸
    ```bash
    cat /etc/wsl.conf
    ```
    - cat <íŒŒì¼ì´ë¦„> : ê°€ì¥ ë§ì´ ì“°ì´ëŠ” ëª…ë ¹ì–´ ì¤‘ í•˜ë‚˜ì´ë©° íŒŒì¼ ë‚´ìš©ì„ í™”ë©´ì— ì¶œë ¥í•´ì¤ë‹ˆë‹¤.

        ```
        [boot]
        systemd = true           # ssh ë“± systemd ì„œë¹„ìŠ¤ ì‚¬ìš©í•˜ë ¤ë©´ ê¶Œì¥

        [automount]
        enabled = false          # /mnt/c ê°™ì€ ìë™ ë§ˆìš´íŠ¸ ì¤‘ì§€
        mountFsTab = true        # /etc/fstab ì‚¬ìš© ì‹œì—ë§Œ ë§ˆìš´íŠ¸

        [interop]
        enabled = false          # ìœˆë„ìš° exe ì‹¤í–‰ ê¸ˆì§€
        appendWindowsPath = false # ìœˆë„ìš° PATH ì„ê¸° ë„ê¸°

        [network]
        generateHosts=false # WSL Ubuntuë¥¼ ì‹¤í–‰í•  ë•Œ, `/etc/hosts` íŒŒì¼ì„ ìë™ìœ¼ë¡œ ë®ì–´ì“°ì§€ ì•Šê¸° ìœ„í•´ ì„¤ì •í•©ë‹ˆë‹¤.
        hostname=<hostname> # WSL Ubuntu ì—ì„œ ì‚¬ìš©í•  hostname        
        ```

3. Ubuntu ì—ì„œ ì ‘ì† ì¢…ë£Œ 
    ```bash
    exit
    ```

4. WSL Ubuntu ì¸ìŠ¤í„´ìŠ¤ ì¢…ë£Œ í›„ ì ‘ì†
    ```Powershell
    > wsl --shutdown

    > wsl
    ```

5. `Powershell` ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
    ```bash
    which powershell.exe
    ```
    - ì•„ë¬´ê²ƒë„ ë‚˜ì˜¤ì§€ ì•Šìœ¼ë©´ ì •ìƒ

    

    
## 3. Ubuntu ì—ì„œ OpenSSH Server ì„¤ì •

-  SSH ë€?

    > SSH(Secure Shell)ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ë‹¤ë¥¸ ì»´í“¨í„°ì— ì•ˆì „í•˜ê²Œ ì ‘ì†í•˜ê³  ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë³´ì•ˆ í”„ë¡œí† ì½œì´ì í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤.

    | ê¸°ëŠ¥            | ì„¤ëª…                                           |
    | ------------- | -------------------------------------------- |
    | **ì›ê²© ì ‘ì†**     | ë‹¤ë¥¸ ì»´í“¨í„°(ì„œë²„ ë“±)ì— ì ‘ì†í•´ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ              |
    | **ì•”í˜¸í™”ëœ í†µì‹ **   | ID, ë¹„ë°€ë²ˆí˜¸, ë°ì´í„° ë“±ì„ ì•”í˜¸í™”í•´ì„œ ì£¼ê³ ë°›ê¸° ë•Œë¬¸ì— ë„ì²­Â·ì¤‘ê°„ì ê³µê²© ë°©ì§€ |
    | **ì¸ì¦ ë°©ì‹**     | ë¹„ë°€ë²ˆí˜¸ ë°©ì‹ ë˜ëŠ” ê³µê°œí‚¤/ê°œì¸í‚¤ ë°©ì‹ìœ¼ë¡œ ì¸ì¦                   |
    | **í¬íŠ¸ ë²ˆí˜¸ ê¸°ë³¸ê°’** | ê¸°ë³¸ í¬íŠ¸ëŠ” `22ë²ˆ`                                 |

- SSH ì ‘ì†ì„ ìœ„í•œ ì„œë²„ í™˜ê²½ ì„¤ì • ( í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ì„œë²„ ì—ì„œëŠ” ì´ ê³¼ì •ì´ ì´ë¯¸ ì™„ë£Œë˜ì–´ ìˆìŒ )

    1. OpenSSH ì„¤ì¹˜:
        > OpenSSH(Open Secure Shell)ëŠ” SSH(Secure Shell) í”„ë¡œí† ì½œì„ êµ¬í˜„í•œ ì˜¤í”ˆì†ŒìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´ íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤.
    
        ```bash
        sudo apt install openssh-server
        ```
    
    2. ì„¤ì¹˜í™•ì¸:
        ```bash
        sudo systemctl status ssh
        ```

        - OpenSSH Server í¬íŠ¸ ë³€ê²½ ( ìœˆë„ìš°ì—ì„œ ì´ë¯¸ 22 í¬íŠ¸ë¥¼ ì‚¬ìš© ì¤‘ì¼ë•Œ )

            1. /etc/ssh/sshd_config íŒŒì¼ ì—´ê¸°
            2. Port 2222 ë¡œ ìˆ˜ì •             
            3. `sudo systemctl stop ssh`
            4. `sudo systemctl stop ssh.socket`
            5. `sudo systemctl restart ssh`
            6. ssh ì ‘ì†í• ë•ŒëŠ” í¬íŠ¸ ì§€ì • ( ì˜ˆ: ssh -p 2222 ì‚¬ìš©ì@localhost )

    3. Ubuntu ë¶€íŒ… ì‹œ ssh ì„œë²„ ìë™ìœ¼ë¡œ ì‹œì‘:
        ```bash
        sudo systemctl enable ssh
        ```
        

    4. `ssh` ì ‘ì† í…ŒìŠ¤íŠ¸ ( ìœˆë„ìš°ì—ì„œ )
        > WSLì€ localhost ë¡œ ìš”ì²­ì‹œ ìë™ìœ¼ë¡œ í¬íŠ¸ê°€ ì—´ë ¤ìˆëŠ” ì¸ìŠ¤í„´ìŠ¤ë¡œ IP í¬ì›Œë”© í•´ì¤Œ. ( ë‹¨ ì™¸ë¶€ì—ì„œ ì ‘ì†ì‹œ í¬íŠ¸í¬ì›Œë”© í•„ìš”í•¨ )

        - OpenSSH ì„¤ì¹˜í™•ì¸:
            ```Powershell
            > ssh -V
            ```
            - ìœˆë„ìš°ì—ì„œ OpenSSH ì—†ì„ê²½ìš°
                1. ì„¤ì • â†’ ì•± â†’ ì„ íƒì  ê¸°ëŠ¥ 
                2. ëª©ë¡ì—ì„œ OpenSSH Clientì™€ OpenSSH Serverë¥¼ ì°¾ì•„ ì„¤ì¹˜
                3. ë§Œì•½ ì—†ìœ¼ë©´ "ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥" í´ë¦­ í›„ ê²€ìƒ‰í•˜ì—¬ ì„¤ì¹˜

        - ê¸°ë³¸ ì ‘ì† ë°©ì‹:

            ```bash
            ssh <ì‚¬ìš©ìì´ë¦„>@localhost -p <í¬íŠ¸ë²ˆí˜¸>
            ```

    5. SSH í‚¤ í˜ì–´ ê¸°ë°˜ ì ‘ì† ì„¤ì • ( ë³´ì•ˆìƒ ì¶”ì²œë˜ëŠ” ë°©ì‹ ) 
        > SSH ì ‘ì† ì‹œ ë¹„ë°€ë²ˆí˜¸ ëŒ€ì‹  ê³µê°œí‚¤(ì„œë²„ì— ì €ì¥) + ë¹„ê³µê°œí‚¤(í´ë¼ì´ì–¸íŠ¸ì— ì €ì¥) ì¡°í•©ìœ¼ë¡œ ì¸ì¦í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

        > ì•„ë˜ëŠ” ìœˆë„ìš° `Powershell` ì—ì„œ ì§„í–‰
        - SSH í‚¤ í˜ì–´ ìƒì„±
            ```Powershell
            > ssh-keygen -C "<ì½”ë©˜íŠ¸>" -f "$env:USERPROFILE\.ssh\<í‚¤ì´ë¦„>"
            ```
            - passphrase ì…ë ¥í•˜ë¼ê³  ëœ¨ëŠ”ë°, ë¬´ì‹œí•˜ê³  ë‘ë²ˆ ì—”í„° ( passphraseëŠ” ë¹„ë°€í‚¤ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì¶”ê°€ ë¹„ë°€ë²ˆí˜¸ )
            - `ssh-keygen` ëª…ë ¹ì–´ëŠ” SSH ì—°ê²°ì— ì‚¬ìš©í•  **ê³µê°œí‚¤(public key)ì™€ ë¹„ê³µê°œí‚¤(private key)** ë¥¼ ìƒì„±í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤. SSH ì¸ì¦ ë°©ì‹ ì¤‘ **ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ì•ˆì „í•˜ê²Œ ì¸ì¦í•˜ëŠ” ë°©ì‹** ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.             

        - ê³µê°œí‚¤ë‘ ë¹„ê³µê°œí‚¤ ìƒì„± í™•ì¸
            ```Powershell
            ls ~/.ssh/
            ```
            - .pub í™•ì¥ìë¥¼ ê°€ì§„ íŒŒì¼ì´ ê³µê°œí‚¤ì„

        - Ubuntu ì„œë²„ì— ê³µê°œí‚¤ ë“±ë¡

            - ê³µê°œí‚¤ë¥¼ ë“±ë¡í•  íŒŒì¼ ìƒì„± 
                ```
                touch ~/.ssh/authorized_keys
                ```
            - ê¶Œí•œ ë³€ê²½
                ```
                chmod 600 ~/.ssh/authorized_keys
                ```
            - `nano` ëª…ë ¹ì–´ë¡œ íŒŒì¼ì„ í¸ì§‘ê¸° í˜•íƒœë¡œ ì—°ë‹¤ìŒ ìœˆë„ìš°ì— ìˆëŠ” .pub íŒŒì¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°
                ```
                nano ~/.ssh/authorized_keys
                ```

                - `nano`ëŠ” Ubuntuì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê°„ë‹¨í•˜ê³  ì§ê´€ì ì¸ í…ìŠ¤íŠ¸ í¸ì§‘ê¸°ì…ë‹ˆë‹¤.

                - ë¶™ì—¬ë„£ê¸° í•œë‹¤ìŒ ìˆœì„œëŒ€ë¡œ 
                    1. `Ctrl` + `X`
                    2. `Y`
                    3. `ì—”í„°`

        - ìœˆë„ìš°ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ë¹„ê³µê°œí‚¤ë¥¼ ì´ìš©í•´ SSH ì ‘ì†
            ```Powershell
            > ssh -i "$env:USERPROFILE\.ssh\<í‚¤ì´ë¦„>" ubuntu@localhost
            ```
            - í¬íŠ¸ë²ˆí˜¸ê°€ ë‹¤ë¥´ë‹¤ë©´ `-p <í¬íŠ¸ë²ˆí˜¸>` ì¶”ê°€

    6. ìœˆë„ìš°ì—ì„œ SSH config ì„¤ì •í•˜ê¸° ( ìì£¼ ì ‘ì†í•˜ëŠ” ì„œë²„ì¼ ê²½ìš° )
        
        - `C:\User\<ì‚¬ìš©ì>\.ssh\config` íŒŒì¼ì„ ì—´ì–´ì„œ, ( ì—†ë‹¤ë©´ ìƒì„± )
            ```
            Host <ë³„ì¹­>
                HostName localhost
                IdentityFile C:\Users\<ìœˆë„ìš°ì‚¬ìš©ìì´ë¦„>\.ssh\<í‚¤ì´ë¦„>
                User ubuntu
            ```
            - Powershell ì—ì„œ pwd ì´ìš© í•˜ë©´ í¸í•¨
                1. `cd ~/.ssh/`
                2. `pwd`
                3. ì¶œë ¥ê²°ê³¼ë¥¼ í‚¤ ì´ë¦„ ì•ì— ë¶™ì—¬ë„£ê¸°.

        - ssh ì ‘ì†
            ```bash
            ssh <ë³„ì¹­>
            ```


## 4. VSCode ë¡œ Ubuntu ì„œë²„ë¡œ SSH ì ‘ì†

1. ì™¼ìª½ì— Remote Explorer í´ë¦­

    ![VSCode Remote SSH1](https://lh3.googleusercontent.com/d/1ACbjDph3R1siAALQST_ACeXkcvg6CV_r)

2. ì™¼ìª½ì— Open Folder í´ë¦­ -> ìƒë‹¨ì— ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©ì ë””ë ‰í„°ë¦¬ê°€ ì…ë ¥ë˜ì–´ ìˆìŒ. -> ì—”í„°


    ![VSCode Remote SSH2](https://lh3.googleusercontent.com/d/1jZ_CkskvkfukHv_5Il1nAo2wmMmC3ISf)
